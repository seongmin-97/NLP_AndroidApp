# chapter 5 - 04 뷰 사용하기

뷰(View)는 화면을 구성하는 최소 단위의 컴포넌트라고 할 수 있다. 계층 구조를 나타낸다면 앱 > 액티비티 > (프래그먼트) > 뷰그룹 > 뷰 로 표시할 수 있다. 뷰그룹은 레이아웃이라고 할 수 있고, 뷰는 위젯이라고 할 수 있다.

우리가 지금까지 화면을 구성하기 위해 레이아웃, 텍스트뷰, 버튼 등을 사용했는데 모두 최상위 클래스인 View 클래스를 상속받아 구현한다.

1. View 클래스 다루기

    위젯과 레이아웃의 최상위 클래스인 View는 화면에 그림을 기리기 위한 메서드를 가지고 있다.

    텍스트뷰 위젯의 text 속성에 안녕하세요 라고 입력하면 TextView는 부모 클래스인 View에 입력된 문자열을 전달하고, View는 문자열을 받아서 글자 크기 색상 위치 등을 결정하고 onDraw()메서드를 사용해서 화면에 그려준다. onDraw() 메서드의 사용법만 정확하게 이해한다면 원하는 위젯이 없어도 직접 만들어서 사용할 수 있다.

    - View에 텍스트 출력하기

        먼저 메인 액티비티 코틀린 파일을 열어 메인 액티비티 클래스 밖에 View를 상속받는 클래스를 하나 만든다. View는 컨텍스트를 생성자에서 입력받아야 하기 때문에 컨텍스트를 입력받는 생성자가 하나 꼭 있어야만 한다.

        그 안에서 onDraw()를 오버라이드 한다. onDraw()의 파라미터로 넘어오는 Canvas는 일종의 그리기 도구이다. 그림을 그리기 위한 메서드들이 제공된다. 텍스트를 출력하기 위해서는 Canvas의 drawText() 메서드를 사용하는데, 출력할 문자열, 가로세로 좌표, 그리고 글자의 색과 두께 정보를 가지고 있는 Paint가 필요하다. Paint객체를 하나 만들어서 변수에 저장하고 color 프로퍼티에 색을 입력한다. 그리고 textSize 프로퍼티에는 100f를 입력한다. 값의 타입이 Float형이기 때문에 f를 같이 입력한다.

        이제 canvas의 drawText() 메서드를 호출해서 택스트로 그려준다. 첫 파라미터부터 글자, x좌표, y좌표, 색상 정보이다. 여기서 좌표는 텍스트의 좌측 하단이 기준이다.

        drawText에서 텍스트를 집어넣을 때 처음 클래스에서 텍스트를 받아 텍스트를 원하는 것으로 출력할 수 있다. 처음 클래스를 지정할 때 원하는 텍스트를 입력받고, init을 통해 this.text에 저장해준다.

    - View에 그림 그리기

        텍스트뿐만 아니라 일반적인 도형도 View에 그릴 수 있다. 도형 그림을 그리는데 필요한 Paint의 프로퍼티를 간단히 먼저 정리하자.

        - color : 대상의 색상, 도형의 색상을 정의한다.
        - style : 도형의 형태, 외곽선을 그리거나 면을 채우는 등의 모양을 정의한다.
        - strokeWidth : 외곽선을 그릴 경우 그 두께를 정의한다.

    1. drawCircle() : 원 그리기
    2. drawArc() : 원호 그리기
    3. drawRect() : 사각형 그리기
    4. drawRoundRect() : 라운드 사각형 그리기

2. 커스텀 위젯 만들기

    회사에서 프로젝트를 진행하면 기본 위젯은 잘 사용하지 않는다. 보통 기본 위젯을 상속받아 앞에 접두어를 붙여 커스텀 위젯으로 사용한다. 위젯의 커스터마이징은 크게 세 단계로 구분된다.

    1. attrs.xml 생성

        새로운 위젯을 생성하고 사용할 때 위젯 이름 뿐 아니라 속성의 이름과 입력되는 값의 타입을 정의하고 사용할 수 있도록 해준다.

    2. 커스텀 위젯 클래스 생성

        커스터마이징을 하기 위한 위젯 클래스를 상속받아 클래스를 생성하고 위에서 새롭게 정의한 속성을 처리하는 코드르 작성한다.

    3. 레이아웃에 태그 적용

        생성된 커스텀 클래스를 레이아웃 파일에 태그로 적용한다. 커스텀 위젯은 컨스트레인트 레이아웃처럼 위젯 클래스의 패키지 경로명도 함께 입력해서 사용한다.

    - 커스텀 TextView의 설계

        날짜를 delimeter에 따라 구분해주는 텍스트뷰를 만들어 보자. delimeter 속성을 새로 만들어 주어야 한다.

        먼저 attrs.xml 속성 파일을 생성한다. 여기에서 커스텀 속성을 적용할 타입이나 그 속성 등을 선언한다. 그리고 이에 대한 클래스를 만들 클래스 파일을 하나 만든다.

        파일이 열리면 선언되어 있는 클래스를 수정해서 AppCompatTextView를 상속받는다. 버전 호환성을 위해 기본 위젯은 TextView가 아닌 AppCompatTextView를 상속받는다.

        위젯 클래스를 소스 코드에서 사용할 때는 Context 하나만 입력받는 첫 번째 생성자가 호출됙, 레이아웃 파일에서는 두 번째 생성자가 주로 호출된다. 커스텀 위젯은 레이아웃에서도 사용되지만 코드에서도 직접 사용할 수 있기 때문에 항상 3개의 생성자를 모두 작성해 놓는 것이 좋다.

        두 번째 생성자에 현재 속성을 확인하고 실행하는 코드를 작성한다. 여기서 실행하는 코드는 따로 생성자 밖에서 작성한다.

    - 레이아웃에서 CustomText 사용하기

        UI편집기 Project 카테고리에서 우리가 만든 위젯이 있음을 알 수 있다. delimeter 속성도 우리가 만들었으므로 존재한다. 하지만 우리가 원하는 대로 구현이 안될 수 있는데, 에뮬레이터를 실행하면 올바르게 실행되는 것을 확인할 수 있다.